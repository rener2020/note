---
title: 车端首页
tags: 新建,模板,小书匠
renderNumberedHeading: true
grammar_cjkRuby: true
---


### 概述

```flow
st=>start: 开始
e=>end: 结束
op0=>operation: 用户启动程序
op1=>operation: 验证mac地址
cond=>condition: mac地址已注册？
op3=>operation: 显示mac错误信息
op2=>operation: 初始化并显示车端主界面
op4=>operation: 显示验证通过信息
st->op0->op1->cond
cond(no)->op3->op1
cond(yes)->op4->op2->e
```

![车端首页](./images/车端首页.png)

初始化并显示车端主界面的主要流程如下：
1. 车辆首页初始化
2. 访问服务端接口，[获取车辆信息](http://192.168.10.106:8080/project/3?p=311)并显示
3. 访问服务端接口，[解绑当前车辆](http://192.168.10.106:8080/project/3?p=312)
4. 获取本机IP地址
5. 在服务端[注册当前车辆](http://192.168.10.106:8080/project/3?p=316)
6. 开启[车辆节点服务](http://192.168.10.106:8080/project/3?p=297)
7. 访问车辆服务端接口，提起车辆端roscore，访问[car_sys_start](http://192.168.10.106:8080/project/3?p=197)
8. 处理车辆节点数据，通过[车辆服务](http://192.168.10.106:8080/project/3?p=297)，获取并更新车辆状态栏车辆数据
9. 启动rviz界面，展示车辆信息

### 具体逻辑
在车端首页初始化时，会开启一个线程运行`start`函数

``` py
# ui/VehicleUi.py
        start_thread_work(self.start)
```

`start`函数是车端首页的主逻辑循环，其具体程序功能如下：
1. 访问服务端接口，[获取车辆信息](http://192.168.10.106:8080/project/3?p=311)并显示
	```py
	# 获取车辆信息
        self.vehicle_info = self.get_vehicle_info()
        self.vehicle_current_data['vehicle_id'] = self.vehicle_info['id']
        # 在ui界面显示车辆id
        self.signal_set_label_vehicle_id.emit(self.vehicle_current_data['vehicle_id'])
	```
2. 